CREATE TABLE PERSON (
    driver_id# VARCHAR(30) PRIMARY KEY,
    name VARCHAR(50),
    address VARCHAR(100)
);

CREATE TABLE CAR (
    regno VARCHAR(20) PRIMARY KEY,
    model VARCHAR(30),
    Year INT
);

CREATE TABLE ACCIDENT (
    report_number INT PRIMARY KEY,
    accd_date DATE,
    location VARCHAR(50)
);

CREATE TABLE OWNS (
    driver_id# VARCHAR(30),
    regno VARCHAR(20),
    PRIMARY KEY (driver_id#, regno),
    FOREIGN KEY (driver_id#) REFERENCES PERSON(driver_id#),
    FOREIGN KEY (regno) REFERENCES CAR(regno)
);

CREATE TABLE PARTICIPATED (
    driver_id# VARCHAR(30),
    regno VARCHAR(20),
    report_number INT,
    damage_amount INT,
    PRIMARY KEY (driver_id#, regno, report_number),
    FOREIGN KEY (driver_id#) REFERENCES PERSON(driver_id#),
    FOREIGN KEY (regno) REFERENCES CAR(regno),
    FOREIGN KEY (report_number) REFERENCES ACCIDENT(report_number)
);


-- Insert into PERSON table
INSERT INTO PERSON VALUES ('D001', 'John Doe', '123 Main St');
INSERT INTO PERSON VALUES ('D002', 'Jane Smith', '456 Oak St');
-- Add more tuples for PERSON table

-- Insert into CAR table
INSERT INTO CAR VALUES ('ABC123', 'Toyota', 2022);
INSERT INTO CAR VALUES ('XYZ789', 'Honda', 2020);
-- Add more tuples for CAR table

-- Insert into ACCIDENT table
INSERT INTO ACCIDENT VALUES (1, '2022-01-10', 'Intersection A');
INSERT INTO ACCIDENT VALUES (2, '2022-02-15', 'Highway B');
-- Add more tuples for ACCIDENT table

-- Insert into OWNS table
INSERT INTO OWNS VALUES ('D001', 'ABC123');
INSERT INTO OWNS VALUES ('D002', 'XYZ789');
-- Add more tuples for OWNS table

-- Insert into PARTICIPATED table
INSERT INTO PARTICIPATED VALUES ('D001', 'ABC123', 1, 5000);
INSERT INTO PARTICIPATED VALUES ('D002', 'XYZ789', 2, 8000);
-- Add more tuples for PARTICIPATED table


UPDATE PARTICIPATED
SET damage_amount = 25000
WHERE regno = 'ABC123' AND report_number = 12;

DELETE FROM ACCIDENT
WHERE EXTRACT(YEAR FROM accd_date) = 2022;

-- To add an attribute
ALTER TABLE PERSON
ADD COLUMN phone_number VARCHAR(15);

-- To delete an attribute
ALTER TABLE PERSON
DROP COLUMN address;

-- Add Check constraint to CAR table for Year to be greater than 2000
ALTER TABLE CAR
ADD CONSTRAINT chk_year CHECK (Year > 2000);
